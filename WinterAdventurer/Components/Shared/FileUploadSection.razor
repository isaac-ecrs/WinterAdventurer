@using Microsoft.AspNetCore.Components.Forms
@using MudBlazor

<MudFileUpload T="IBrowserFile" FilesChanged="OnFileSelected" Accept=".xlsx">
    <ActivatorContent>
        <MudButton Variant="Variant.Filled"
                   Color="Color.Primary"
                   StartIcon="@Icons.Material.Filled.CloudUpload"
                   Disabled="@IsLoading"
                   Class="file-upload-button">
            Upload Excel File
        </MudButton>
    </ActivatorContent>
</MudFileUpload>

@if (IsLoading)
{
    <div class="loading-container">
        <MudProgressCircular Color="Color.Primary" Indeterminate="true" Size="Size.Small" />
        <MudText Class="loading-text">Processing...</MudText>
    </div>
}

@code {
    /// <summary>
    /// Event callback invoked when a file is uploaded
    /// </summary>
    [Parameter]
    public EventCallback<IBrowserFile> OnFileUploaded { get; set; }

    /// <summary>
    /// Indicates whether the file is currently being processed
    /// </summary>
    [Parameter]
    public bool IsLoading { get; set; }

    private async Task OnFileSelected(IBrowserFile file)
    {
        await OnFileUploaded.InvokeAsync(file);
    }
}
